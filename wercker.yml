box: node
build:
  steps:
    - npm-install
push:
  steps:
    - internal/docker-push:
        username: $USERNAME
        password: $PASSWORD
        repository: tadakamalla/mynode
        tag: latest
        registry: https://registry.hub.docker.com/v2
        cmd: node /pipeline/source/server.js
        
deploy:
  steps:
    - script:
        name: webhook
        code: 
        curl -k -X POST https://129.144.145.176/api/v2/deployments/Demostack-20180412-202415/webhook/restart?token=jvxavtpp
        curl -X DELETE http://129.213.118.53:8080/api/v1/namespaces/default/pods/  --header "Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJkZWZhdWx0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6ImRlZmF1bHQtdG9rZW4tc253NjkiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGVmYXVsdCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6IjlmMWFlMmZmLTRjODYtMTFlOC1hYjRlLTAyMDAxNzAyOGQ5ZiIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDpkZWZhdWx0OmRlZmF1bHQifQ.QChVU6AdMLt3kXp66bRyazHFGkST7h1x3azNPTCV7v9R2DfSinadEpXoLHCZuWfzxPMbjuweak8vS5QWE6jNUhTF0fvUKoGybcUE63yeyVM0rgWPqjKxw0SqkC5FXhGUGKAq-82UAFtqG-0FPzPMsYtfIGP1Up4_N5Eg_tZA5ZDx3k4NRYsAIYogeS4f6nlniRIv4LNTetJIUx79pE369hi-FgQMSb4Dqe8_rN7r5IBdt0SdWiUD9zNHevFYM9BCyi4ppK7hswZfOfL-y-PZ5Fd_1ZmpG6u1KXX0k0d2h9SRyi76EP6XOaq5YpEgEV239Z0Nr0diJrwsnd6EwRFtZA" --insecure
           
