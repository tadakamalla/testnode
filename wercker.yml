box: node
build:
  steps:
    - npm-install
    - internal/watch:
        code: node server.js
        reload: true 
    - script:
        name: copy files to the pipeline
        code: cp -R . "$WERCKER_OUTPUT_DIR"    
push:
  steps:
    - script:
        name: copy
        code: cp -R /pipeline/source/. /usr/src/app/
    - internal/docker-push:
        username: $USERNAME
        password: $PASSWORD
        ports: "8085"
        tag: my-wercker-tag
        repository: tadakamalla/mynode
        registry: https://index.docker.io/v1/
        cmd: npm start
deploy:
  steps:
    - script:
        name: webhook
        code: 
         curl -k -X POST https://140.86.13.180/api/v2/deployments/tadakamalla-mynode-20170827-171024/webhook/restart?token=dugphkye
